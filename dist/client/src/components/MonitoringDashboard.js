"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const jsx_runtime_1 = require("react/jsx-runtime");
const react_1 = require("react");
const errorService_1 = require("../services/errorService");
const MonitoringDashboard = () => {
    const [errorStats, setErrorStats] = (0, react_1.useState)(null);
    const [performanceStats, setPerformanceStats] = (0, react_1.useState)(null);
    const [isLoading, setIsLoading] = (0, react_1.useState)(true);
    const [activeTab, setActiveTab] = (0, react_1.useState)('errors');
    (0, react_1.useEffect)(() => {
        loadStats();
        const interval = setInterval(loadStats, 30000);
        return () => clearInterval(interval);
    }, []);
    const loadStats = async () => {
        try {
            setIsLoading(true);
            const errors = errorService_1.errorService.getErrors();
            setErrorStats({
                totalErrors: errors.length,
                errorsByType: errors.reduce((acc, error) => {
                    acc[error.message] = (acc[error.message] || 0) + 1;
                    return acc;
                }, {}),
                recentErrors: errors.slice(-10)
            });
            try {
                const response = await fetch('/api/admin/performance');
                if (response.ok) {
                    const perfStats = await response.json();
                    setPerformanceStats(perfStats);
                }
            }
            catch (error) {
                console.warn('Could not load performance stats:', error);
            }
        }
        catch (error) {
            console.error('Failed to load monitoring stats:', error);
        }
        finally {
            setIsLoading(false);
        }
    };
    const formatBytes = (bytes) => {
        if (bytes === 0)
            return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    };
    const formatDuration = (ms) => {
        if (ms < 1000)
            return `${ms.toFixed(2)}ms`;
        return `${(ms / 1000).toFixed(2)}s`;
    };
    if (isLoading) {
        return ((0, jsx_runtime_1.jsx)("div", { className: "flex items-center justify-center h-64", children: (0, jsx_runtime_1.jsx)("div", { className: "animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600" }) }));
    }
    return ((0, jsx_runtime_1.jsxs)("div", { className: "max-w-7xl mx-auto p-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "mb-6", children: [(0, jsx_runtime_1.jsx)("h1", { className: "text-3xl font-bold text-gray-900 dark:text-gray-100", children: "System Monitoring Dashboard" }), (0, jsx_runtime_1.jsx)("p", { className: "text-gray-600 dark:text-gray-400 mt-2", children: "Real-time monitoring of system performance, errors, and audit trails" })] }), (0, jsx_runtime_1.jsx)("div", { className: "mb-6", children: (0, jsx_runtime_1.jsx)("nav", { className: "flex space-x-8", children: [
                        { id: 'errors', label: 'Error Monitoring', count: errorStats?.totalErrors || 0 },
                        { id: 'performance', label: 'Performance', count: performanceStats?.totalOperations || 0 },
                        { id: 'audit', label: 'Audit Trail', count: 0 }
                    ].map((tab) => ((0, jsx_runtime_1.jsxs)("button", { onClick: () => setActiveTab(tab.id), className: `py-2 px-1 border-b-2 font-medium text-sm ${activeTab === tab.id
                            ? 'border-blue-500 text-blue-600 dark:text-blue-400'
                            : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300'}`, children: [tab.label, tab.count > 0 && ((0, jsx_runtime_1.jsx)("span", { className: "ml-2 bg-red-100 text-red-800 text-xs font-medium px-2 py-0.5 rounded-full", children: tab.count }))] }, tab.id))) }) }), activeTab === 'errors' && errorStats && ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-1 md:grid-cols-4 gap-6", children: [(0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg", children: (0, jsx_runtime_1.jsx)("div", { className: "p-5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-8 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-red-600 dark:text-red-400", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z", clipRule: "evenodd" }) }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "ml-5 w-0 flex-1", children: (0, jsx_runtime_1.jsxs)("dl", { children: [(0, jsx_runtime_1.jsx)("dt", { className: "text-sm font-medium text-gray-500 dark:text-gray-400 truncate", children: "Total Errors" }), (0, jsx_runtime_1.jsx)("dd", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: errorStats.totalErrors })] }) })] }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg", children: (0, jsx_runtime_1.jsx)("div", { className: "p-5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-8 bg-yellow-100 dark:bg-yellow-900 rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-yellow-600 dark:text-yellow-400", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z", clipRule: "evenodd" }) }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "ml-5 w-0 flex-1", children: (0, jsx_runtime_1.jsxs)("dl", { children: [(0, jsx_runtime_1.jsx)("dt", { className: "text-sm font-medium text-gray-500 dark:text-gray-400 truncate", children: "High Severity" }), (0, jsx_runtime_1.jsx)("dd", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: Object.values(errorStats.errorsByType).reduce((sum, count) => sum + count, 0) })] }) })] }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg", children: (0, jsx_runtime_1.jsx)("div", { className: "p-5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-blue-600 dark:text-blue-400", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z", clipRule: "evenodd" }) }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "ml-5 w-0 flex-1", children: (0, jsx_runtime_1.jsxs)("dl", { children: [(0, jsx_runtime_1.jsx)("dt", { className: "text-sm font-medium text-gray-500 dark:text-gray-400 truncate", children: "Network Errors" }), (0, jsx_runtime_1.jsx)("dd", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: Object.keys(errorStats.errorsByType).length })] }) })] }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg", children: (0, jsx_runtime_1.jsx)("div", { className: "p-5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-8 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-green-600 dark:text-green-400", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z", clipRule: "evenodd" }) }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "ml-5 w-0 flex-1", children: (0, jsx_runtime_1.jsxs)("dl", { children: [(0, jsx_runtime_1.jsx)("dt", { className: "text-sm font-medium text-gray-500 dark:text-gray-400 truncate", children: "System Health" }), (0, jsx_runtime_1.jsx)("dd", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: errorStats.totalErrors === 0 ? '100%' : 'Good' })] }) })] }) }) })] }), (0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 shadow rounded-lg", children: (0, jsx_runtime_1.jsxs)("div", { className: "px-4 py-5 sm:p-6", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-lg leading-6 font-medium text-gray-900 dark:text-gray-100", children: "Recent Errors" }), (0, jsx_runtime_1.jsx)("div", { className: "mt-5", children: errorStats.recentErrors.length === 0 ? ((0, jsx_runtime_1.jsx)("p", { className: "text-gray-500 dark:text-gray-400", children: "No recent errors" })) : ((0, jsx_runtime_1.jsx)("div", { className: "space-y-3", children: errorStats.recentErrors.slice(0, 5).map((error, index) => ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded", children: [(0, jsx_runtime_1.jsxs)("div", { children: [(0, jsx_runtime_1.jsx)("p", { className: "text-sm font-medium text-gray-900 dark:text-gray-100", children: error.message }), (0, jsx_runtime_1.jsx)("p", { className: "text-xs text-gray-500 dark:text-gray-400", children: error.context?.timestamp })] }), (0, jsx_runtime_1.jsx)("span", { className: `inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${error.severity === 'high' ? 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200' :
                                                        error.severity === 'medium' ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200' :
                                                            'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'}`, children: error.severity })] }, index))) })) })] }) })] })), activeTab === 'performance' && performanceStats && ((0, jsx_runtime_1.jsxs)("div", { className: "space-y-6", children: [(0, jsx_runtime_1.jsxs)("div", { className: "grid grid-cols-1 md:grid-cols-4 gap-6", children: [(0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg", children: (0, jsx_runtime_1.jsx)("div", { className: "p-5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-blue-600 dark:text-blue-400", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z", clipRule: "evenodd" }) }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "ml-5 w-0 flex-1", children: (0, jsx_runtime_1.jsxs)("dl", { children: [(0, jsx_runtime_1.jsx)("dt", { className: "text-sm font-medium text-gray-500 dark:text-gray-400 truncate", children: "Total Operations" }), (0, jsx_runtime_1.jsx)("dd", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: performanceStats.totalOperations })] }) })] }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg", children: (0, jsx_runtime_1.jsx)("div", { className: "p-5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-8 bg-green-100 dark:bg-green-900 rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-green-600 dark:text-green-400", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.293l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z", clipRule: "evenodd" }) }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "ml-5 w-0 flex-1", children: (0, jsx_runtime_1.jsxs)("dl", { children: [(0, jsx_runtime_1.jsx)("dt", { className: "text-sm font-medium text-gray-500 dark:text-gray-400 truncate", children: "Average Duration" }), (0, jsx_runtime_1.jsx)("dd", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: formatDuration(performanceStats.averageDuration) })] }) })] }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg", children: (0, jsx_runtime_1.jsx)("div", { className: "p-5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-8 bg-red-100 dark:bg-red-900 rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-red-600 dark:text-red-400", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { fillRule: "evenodd", d: "M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z", clipRule: "evenodd" }) }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "ml-5 w-0 flex-1", children: (0, jsx_runtime_1.jsxs)("dl", { children: [(0, jsx_runtime_1.jsx)("dt", { className: "text-sm font-medium text-gray-500 dark:text-gray-400 truncate", children: "Slowest Operation" }), (0, jsx_runtime_1.jsx)("dd", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: performanceStats.slowestOperation ?
                                                                formatDuration(performanceStats.slowestOperation.duration) :
                                                                'N/A' })] }) })] }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 overflow-hidden shadow rounded-lg", children: (0, jsx_runtime_1.jsx)("div", { className: "p-5", children: (0, jsx_runtime_1.jsxs)("div", { className: "flex items-center", children: [(0, jsx_runtime_1.jsx)("div", { className: "flex-shrink-0", children: (0, jsx_runtime_1.jsx)("div", { className: "w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center", children: (0, jsx_runtime_1.jsx)("svg", { className: "w-5 h-5 text-purple-600 dark:text-purple-400", fill: "currentColor", viewBox: "0 0 20 20", children: (0, jsx_runtime_1.jsx)("path", { d: "M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z" }) }) }) }), (0, jsx_runtime_1.jsx)("div", { className: "ml-5 w-0 flex-1", children: (0, jsx_runtime_1.jsxs)("dl", { children: [(0, jsx_runtime_1.jsx)("dt", { className: "text-sm font-medium text-gray-500 dark:text-gray-400 truncate", children: "Peak Memory" }), (0, jsx_runtime_1.jsx)("dd", { className: "text-lg font-medium text-gray-900 dark:text-gray-100", children: formatBytes(performanceStats.peakMemoryUsage) })] }) })] }) }) })] }), (0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 shadow rounded-lg", children: (0, jsx_runtime_1.jsxs)("div", { className: "px-4 py-5 sm:p-6", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-lg leading-6 font-medium text-gray-900 dark:text-gray-100", children: "Operations by Type" }), (0, jsx_runtime_1.jsx)("div", { className: "mt-5", children: (0, jsx_runtime_1.jsx)("div", { className: "space-y-3", children: Object.entries(performanceStats.operationsByType).map(([operation, count]) => ((0, jsx_runtime_1.jsxs)("div", { className: "flex items-center justify-between", children: [(0, jsx_runtime_1.jsx)("span", { className: "text-sm font-medium text-gray-900 dark:text-gray-100", children: operation }), (0, jsx_runtime_1.jsxs)("span", { className: "text-sm text-gray-500 dark:text-gray-400", children: [count, " operations"] })] }, operation))) }) })] }) })] })), activeTab === 'audit' && ((0, jsx_runtime_1.jsx)("div", { className: "bg-white dark:bg-gray-800 shadow rounded-lg", children: (0, jsx_runtime_1.jsxs)("div", { className: "px-4 py-5 sm:p-6", children: [(0, jsx_runtime_1.jsx)("h3", { className: "text-lg leading-6 font-medium text-gray-900 dark:text-gray-100", children: "Audit Trail" }), (0, jsx_runtime_1.jsx)("p", { className: "mt-2 text-sm text-gray-500 dark:text-gray-400", children: "Audit trail functionality will be available once the backend is fully connected." })] }) }))] }));
};
exports.default = MonitoringDashboard;
//# sourceMappingURL=MonitoringDashboard.js.map